<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="911" height="879"><defs/><g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 0 0 L 891 0 L 891 859 L 0 859 L 0 0" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#ffffff" stroke="none" d="M 0 0 L 0 22 L 192.97265625 22 L 203.97265625 11 L 203.97265625 0 L 0 0"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 0 0 L 0 22 L 192.97265625 22 L 203.97265625 11 L 203.97265625 0 L 0 0 L 0 0" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="70.97900390625" y="17.5">OWTP协议交互流程</text></g></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="5" y="17.5">interaction</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="151" y="47" width="71.736328125" height="39" opacity="0.2"/></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="144" y="40" width="71.736328125" height="39"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 144 40 L 215.736328125 40 L 215.736328125 79 L 144 79 L 144 40 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="162.53271484375" y="59.5">A节点</text></g></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180.5 80 L 180.5 816" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(10,10) scale(1,1)"><rect fill="#C0C0C0" stroke="none" x="671" y="47" width="71.736328125" height="39" opacity="0.2"/></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="664" y="40" width="71.736328125" height="39"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 664 40 L 735.736328125 40 L 735.736328125 79 L 664 79 L 664 40 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="bold" text-decoration="none" x="682.53271484375" y="59.5">B节点</text></g></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700.5 80 L 700.5 824" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 96 L 210 96 L 210 116 L 186 116" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 111.79048224398402 L 186 116 L 196.16267485762415 120.20951775601598"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 111.79048224398402 L 186 116 L 196.16267485762415 120.20951775601598 L 196.16267485762415 111.79048224398402" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="215.5" y="111.5">1 : 开启端口监听http请求</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="116" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 116 L 186 116 L 186 144 L 173 144 L 173 116 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 144 L 730 144 L 730 164 L 706 164" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 716.1626748576241 159.790482243984 L 706 164 L 716.1626748576241 168.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 716.1626748576241 159.790482243984 L 706 164 L 716.1626748576241 168.209517756016 L 716.1626748576241 159.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="470.5" y="158.5">2 : 创建OWTP客户端，配置服务路由器</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="693" y="164" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 693 164 L 706 164 L 706 192 L 693 192 L 693 164 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 208 L 186 208" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 203.790482243984 L 186 208 L 196.16267485762415 212.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 203.790482243984 L 186 208 L 196.16267485762415 212.209517756016 L 196.16267485762415 203.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="249.8291015625" y="224.5">3 : 发起websocket连接请求（ws?公钥&amp;签名&amp;随机nonce&amp;时间戳）</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="208" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 208 L 186 208 L 186 236 L 173 236 L 173 208 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 264 L 210 264 L 210 284 L 186 284" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 279.790482243984 L 186 284 L 196.16267485762415 288.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 279.790482243984 L 186 284 L 196.16267485762415 288.209517756016 L 196.16267485762415 279.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="222.5" y="279.5">4 : 创建独立的OWTP客户端，加入到节点管理，配置服务路由</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="284" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 284 L 186 284 L 186 312 L 173 312 L 173 284 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 336 L 210 336 L 210 356 L 186 356" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 351.790482243984 L 186 356 L 196.16267485762415 360.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 351.790482243984 L 186 356 L 196.16267485762415 360.209517756016 L 196.16267485762415 351.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="215.5" y="351.5">5 : 验证公钥是否可信认，通过AB公钥协商计算一个通信密钥</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="356" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 356 L 186 356 L 186 384 L 173 384 L 173 356 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 408 L 693 408" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 682.8373251423759 412.209517756016 L 693 408 L 682.8373251423758 403.790482243984"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 682.8373251423759 412.209517756016 L 693 408 L 682.8373251423758 403.790482243984 L 682.8373251423759 412.209517756016" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="338.5" y="403.5">6 : 发送A的公钥和协商结果请求</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="693" y="408" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 693 408 L 706 408 L 706 436 L 693 436 L 693 408 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 448 L 730 448 L 730 468 L 706 468" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 716.1626748576241 463.790482243984 L 706 468 L 716.1626748576241 472.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 716.1626748576241 463.790482243984 L 706 468 L 716.1626748576241 472.209517756016 L 716.1626748576241 463.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="519.5" y="467.5">7 : B也根据A公钥计算出密钥</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="693" y="468" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 693 468 L 706 468 L 706 496 L 693 496 L 693 468 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 520 L 180 520" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 190.16267485762415 515.790482243984 L 180 520 L 190.16267485762415 524.209517756016" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="367.5" y="536.5">8 : 返回B计算的协商结果</text></g></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 552 L 210 552 L 210 572 L 186 572" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 567.790482243984 L 186 572 L 196.16267485762415 576.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 567.790482243984 L 186 572 L 196.16267485762415 576.209517756016 L 196.16267485762415 567.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="222.5" y="572.5">9 : 协商通过，保持通信，协商失败，断开连接</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="572" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 572 L 186 572 L 186 600 L 173 600 L 173 572 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 640 L 186 640" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 196.16267485762415 635.790482243984 L 186 640 L 196.16267485762415 644.209517756016"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 196.16267485762415 635.790482243984 L 186 640 L 196.16267485762415 644.209517756016 L 196.16267485762415 635.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="326.5" y="633.5">10 : 请求A节点提供的业务接口（加密）</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="173" y="640" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 173 640 L 186 640 L 186 668 L 173 668 L 173 640 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 672 L 700 672" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 689.8373251423759 676.209517756016 L 700 672 L 689.8373251423758 667.790482243984" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="341.982421875" y="687.5">11 : 返回业务处理结果（加密）</text></g></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 180 744 L 693 744" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="#000000" stroke="none" d="M 682.8373251423759 748.209517756016 L 693 744 L 682.8373251423758 739.790482243984"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 682.8373251423759 748.209517756016 L 693 744 L 682.8373251423758 739.790482243984 L 682.8373251423759 748.209517756016" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="320.5" y="732.5">12 : 请求B节点提供的业务接口（加密）</text></g></g><g transform="translate(10,10) scale(1,1)"><rect fill="#ffffff" stroke="none" x="693" y="744" width="13" height="28"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 693 744 L 706 744 L 706 772 L 693 772 L 693 744 Z Z" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 700 776 L 180 776" stroke-miterlimit="10" stroke-dasharray="3"/></g><g transform="translate(10,10) scale(1,1)"><path fill="none" stroke="#000000" d="M 190.16267485762415 771.790482243984 L 180 776 L 190.16267485762415 780.209517756016" stroke-miterlimit="10"/></g><g transform="translate(10,10) scale(1,1)"><g><path fill="none" stroke="none"/><text fill="#000000" stroke="none" font-family="Arial" font-size="13px" font-style="normal" font-weight="normal" text-decoration="none" x="341.5" y="792.5">13 : 返回业务处理结果（加密）</text></g></g></g></svg>